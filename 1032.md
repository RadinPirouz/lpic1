# 103.2. Process text streams using filters

## **103.2 Process text streams using filters**

**Weight:**3

**Description:** Candidates should be able to apply filters to text streams.

**Key Knowledge Areas:**

Send text files and output streams through text utility filters to modify the output using standard UNIX commands found in the GNU textutils package

**Terms and Utilities:**

* cat
* cut
* expand
* fmt
* head
* join
* less
* nl
* od
* paste
* pr
* sed
* sort
* split
* tail
* tr
* unexpand
* uniq
* wc


### streams

A stream is nothing more than a sequence of bytes that is passed from one file, device, or program to another.


These streams are:

* **standard input stream (stdin)**, which provides input to commands.
* **standard output stream (stdout)**, which displays output from commands.
* **standard error stream (stderr)**, which displays error output from commands.

The streams are also numbered: **stdin (0)** ,**stdout (1)**, **stderr (2)**.

### piping with |

Piping is a mechanism for sending data from one program to another.


```
command1 | command2 | command3 | command 4 | ...
```
```
[root@centos7-1 ~]# dmesg | less
```
### Redirection

Linux includes redirection commands for each stream.We can use `>` in order to redirect output stream (mostly to a file).

```
[root@centos7-1 temp]# ls -1 > list.txt
```
> "|" vs ">"
>
> The difference between > (redirection operator) and | (pipeline operator) is that while the >  connects a command with a file, the | connects the output of a command with another command.

### Text filtering

## cat

The **cat **(short for “**concatenate**“) command is one of the most frequently used command in Linux/Unix like operating systems

```
cat [OPTION] [FILE]...
```


```
[root@centos7-1 ~]# cat file1
This is 1st line of file1.

This is 3rd line of file1.
```

```
[root@centos7-1 ~]# cat file1 file2
```
create a new file with cat:

```
[root@centos7-1 ~]# cat > newfile2
This is my second new file with input redirection
Ctrl+d
[root@centos7-1 ~]# cat newfile2
This is my second new file with input redirection
```
> "-" A hyphen (used alone) generally signifies that input will be taken from stdin as opposed to a named file:
>
> ```
> [root@centos7-1 ~]# cat file1 - file2
> This is 1st line of file1.
>
> This is 3rd line of file1.
> THIS IS MY INPUT
> Ctrl+d
> This is 1st line of file2.
> This is 2nd line of file2.
>
> This is 4th line of file2.
> ```


```
  -A, --show-all           equivalent to -vET
  -b, --number-nonblank    number nonempty output lines, overrides -n
  -e                       equivalent to -vE
  -E, --show-ends          display $ at end of each line
  -n, --number             number all output lines
  -s, --squeeze-blank      suppress repeated empty output lines
  -t                       equivalent to -vT
  -T, --show-tabs          display TAB characters as ^I
  -u                       (ignored)
  -v, --show-nonprinting   use
```

Now what’s the opposite of cat? Yeah it’s ‘tac‘. `tac` is a command under Linux, try it for yourself.


## od

od (Octal dump) command in Linux is used to output the contents of a file in different formats with the octal format.

```
od [OPTION]... [FILE]...
```

as and example:

```
[root@centos7-1 ~]# cat testod.txt
1
2
3
4
5
[root@centos7-1 ~]# od testod.txt
0000000 005061 005062 005063 005064 005065
0000012
```

With `-t` option we can select output format and display it. (Traditional format specifications may be intermixed):

```
-a same as -t a, select named characters, ignoring high-order bit
-b same as -t o1, select octal bytes
-c same as -t c, select printable characters or backslash escapes
-d same as -t u2, select unsigned decimal 2-byte units
-f same as -t fF, select floats
-i same as -t dI, select decimal ints
-l same as -t dL, select decimal longs
-o same as -t o2, select octal 2-byte units
-s same as -t d2, select decimal 2-byte units
-x same as -t x2, select hexadecimal 2-byte units
```

example:

```
[root@centos7-1 ~]# od -ta testod.txt
0000000   1  nl   2  nl   3  nl   4  nl   5  nl
0000012
[root@centos7-1 ~]# od -tc testod.txt
0000000   1  \n   2  \n   3  \n   4  \n   5  \n
0000012
```

`-A` Option displays the contents of input in different format by concatenation some special character (offsets).

* **Hexadecimal (using -x along with -A)**
* **Octal (using -o along with -A)**
* **Decimal (using -d along with -A)**

```
[root@centos7-1 ~]# od -Ax -c testod.txt
000000   1  \n   2  \n   3  \n   4  \n   5  \n
00000a
[root@centos7-1 ~]# od -Ao -c testod.txt
0000000   1  \n   2  \n   3  \n   4  \n   5  \n
0000012
[root@centos7-1 ~]# od -Ad -c testod.txt
0000000   1  \n   2  \n   3  \n   4  \n   5  \n
0000010
```

`-An` Option displays the contents of input in character format but with no offset information:

```
[root@centos7-1 ~]# od -An -c testod.txt
   1  \n   2  \n   3  \n   4  \n   5  \n
```

## expand and unexpand

The **expand **command is used to convert tabs in files to spaces.

```
 expand [OPTION]... [FILE]...
```

lets try it :

```
[root@centos7-1 ~]# cat test.txt
this    is    my    test    file.
[root@centos7-1 ~]# od -tc -An test.txt
   t   h   i   s  \t   i   s  \t   m   y  \t   t   e   s   t  \t
   f   i   l   e   .  \n
[root@centos7-1 ~]# expand test.txt > expanded.txt
[root@centos7-1 ~]# od -tc -An expanded.txt
   t   h   i   s                   i   s
   m   y                           t   e   s   t
   f   i   l   e   .  \n
```

By default, expand converts tabs into the corresponding number of spaces. But it is possible to tweak the number of spaces using the -t (– – tabs=N) command line option. This option requires us to enter the new number of spaces(N) we want the tabs to get converted.

```
[root@centos7-1 ~]# expand -t1 test.txt > expanded2.txt
[root@centos7-1 ~]# od -tc -An expanded2.txt
   t   h   i   s       i   s       m   y       t   e   s   t
   f   i   l   e   .  \n
```

expand command options:

```
  -i, --initial       do not convert tabs after non blanks
  -t, --tabs=NUMBER   have tabs NUMBER characters apart, not 8
  -t, --tabs=LIST     use comma separated list of explicit tab positions
      --help     display this help and exit
      --version  output version information and exit
```
The **unexpand **command is used to convert space characters (blanks) into tabs in each file(unexpand needs at least two spaces).

```
unexpand [OPTION]... [FILE]...
```

Lets do reverse:

```
[root@centos7-1 ~]# unexpand expanded.txt > unexpanded.txt
[root@centos7-1 ~]# od -tc -An unexpanded.txt
   t   h   i   s                   i   s
   m   y                           t   e   s   t
   f   i   l   e   .  \n
```




